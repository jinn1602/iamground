/*  */ function __init_detail(){function a(){DETAIL.view.slick(),DETAIL.view.colorAmongFacGroup(SERVER.fNum),CORE.view.setLeftHeight(),CORE.view.affixLeft(),DETAIL.view.nmap(),$("#search").addClass("active"),DETAIL.action.leftFold()}CORE.toggleScroll(),CORE.loading(),a(),ga("ec:addImpression",{id:"P"+SERVER.service+SERVER.fNum,name:SERVER.service+"_"+SERVER.fNum+"_resv",category:"reservation",brand:"iamground",variant:"pc",list:SERVER.service,position:1,dimension1:""}),ga("ec:addProduct",{id:"P"+SERVER.service+SERVER.fNum,name:SERVER.service+"_"+SERVER.fNum+"_resv",category:"reservation",brand:"iamground",variant:"pc",position:2}),ga("ec:setAction","detail"),ga("send","pageview")}function href_to(){window.location.reload()}function __init_resv(){function a(){var a="";if(0!=SERVER.loginChk&&(a='<input class="form-control" name="team-name" id="teamName" value="'+RESV.server.userTeamArr.user.name+'팀" />',0==RESV.server.userTeamArr.resvTeam.info.length)){RESV.server.userTeamArr.resvTeam.list="";var b=SERVER.skel.resvChk.split('<select class="form-control" id="teamName"></select>');SERVER.skel.resvChk=b[0]+a+b[1]}RESV.view.setupDatepicker(),RESV.view.calendar.setCalendarDate(SERVER.dayOffset),RESV.view.table.setTableDate(),RESV.action.listener(RESV.server),CORE.utility.reservation.genTimeSelectPCDetail(SERVER,SERVER.resvArr,SERVER.dayOffset,"closed",""),CORE.utility.reservation.initSly(SERVER,"select_time_pc",".time-scroller",".schedule-view"),RESV.action.leftFold()}a()}function __init_resvFut(){DETAIL.view.size(40,20),$("#search").click(function(){window.location.href="/futsal/search"}),$("#team").click(function(){window.location.href="/futsal/team"})}var DETAIL={view:{},action:{},toggler:{nmap:"open"}};DETAIL.view.slick=function(){function a(){$("#bigSlickContainer").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!1,asNavFor:"#smallSlickContainer",dots:!0})}function b(){$("#smallSlickContainer").slick({slidesToShow:7,slidesToScroll:1,arrows:!1,asNavFor:"#bigSlickContainer",focusOnSelect:!0})}function c(){$("#smallSlickContainer .slick-slide[data-slick-index=0]").addClass("slick-nav-main"),$("#bigSlickContainer").on("beforeChange",function(a,b,c,d){$("#smallSlickContainer .slick-nav-main").removeClass("slick-nav-main"),$("#smallSlickContainer .slick-slide[data-slick-index="+d+"]").addClass("slick-nav-main")})}a(),b(),c()},DETAIL.view.colorAmongFacGroup=function(a){var b=".fac-group-"+a;$(b).addClass("fac-group-active")},DETAIL.view.size=function(a,b){function c(){n<=a?(e=m/a,i=$("#sizeStandard"),j=$("#sizeFac"),g=n):(e=m/n,i=$("#sizeFac"),j=$("#sizeStandard"),g=a),o<=b?(f=e*b,k=$("#sizeStandard"),l=$("#sizeFac"),h=o):(f=e*o,k=$("#sizeFac"),l=$("#sizeStandard"),h=b)}function d(){var a=e*g,b=e*h,c=m-a,d=f-b;i.width(m),j.width(a),j.css({"margin-left":c/2+"px"}),k.height(f),l.height(b),l.css({"margin-top":d/2+"px"}),$("#sizeVersus>div>h2").text(SERVER.player+" VS "+SERVER.player),$("#sizeVersus").css({top:.7*f-$("#sizeVersus").height()/2+"px"})}var e,f,g,h,i,j,k,l,m=$("#sizeContainer").innerWidth(),n=SERVER.sizeX,o=SERVER.sizeY;void 0!==a&&"number"==typeof a&&void 0!==b&&"number"==typeof b&&void 0!==n&&"number"==typeof n&&void 0!==o&&"number"==typeof o||zuck.ERROR.fatalClientLoad("Size Parse Error"),c(),$("#sizeCompareContainer").height(f).width(m),d()},DETAIL.view.nmap=function(){if("object"!=typeof NAVER&&zuck.ERROR.fatalClientLoad("Naver map load error"),NAVER.launch("nmap",$("#mapIcon").attr("src")),NAVER.getIconCo($("#mapIconCo").attr("src")),NAVER.isActive){var a={longitude:SERVER.longitude,latitude:SERVER.latitude,fName:SERVER.fName,fNum:SERVER.fNum,co:SERVER.co},b=[a];NAVER.drawPointers(b,"detail")}},DETAIL.action.leftFold=function(){$("#nmapTitle").click(function(){"open"===DETAIL.toggler.nmap?(DETAIL.toggler.nmap="close",$("#nmap").css({height:"1px",width:"1px",overflow:"hidden"}),$("#nmapTitle>.glyphicon").removeClass("glyphicon-minus").addClass("glyphicon-plus")):(DETAIL.toggler.nmap="open",$("#nmap").css({height:"300px",width:"300px",overflow:"hidden"}),$("#nmapTitle>.glyphicon").removeClass("glyphicon-plus").addClass("glyphicon-minus"))})};var RESV={view:{},action:{},toggler:{calendar:"open"},server:{pay:SERVER.pay,service:SERVER.service,userTeamArr:SERVER.userTeamArr,loginChk:SERVER.loginChk},badge:SERVER.resvArr.totalNum,fileData:new FormData};RESV.AJAX={get_agreement:function(){$.ajax({url:RESV.agreeUrl,dataType:"text",method:"POST",data:{from:"get_agreement_reserv"},success:function(a){$("#agreeResvContent").val(a)},error:function(a){zuck.alert("danger","잘못된 접근","약관을 불러오지 못하였습니다.")}}),$.ajax({url:RESV.agreeUrl,dataType:"text",method:"POST",data:{from:"get_agreement_fac",fNum:SERVER.fNum,service:SERVER.service,pay:SERVER.pay},success:function(a){$("#agreeFacContent").val(a)},error:function(a){zuck.alert("danger","잘못된 접근","약관을 불러오지 못하였습니다.")}})},fileUpload:function(){return $.ajax({url:RESV.upload+"?doc_type=reserv",data:RESV.fileData,cache:!1,contentType:!1,processData:!1,type:"POST"})},requestToAdm:function(a,b,c){$.ajax({url:"/api/v1/reservation/request",dataType:"text",method:"POST",data:{fNum:SERVER.fNum,pay_chk:SERVER.pay,totalPrice:a.price,scheduleList:JSON.stringify(b),sDate:$.datepicker.formatDate("yy-mm-dd",a.sDate),sTime:a.sTime,time_length:a.time_length,tNum:a.tNum,tName:a.tName,userName:c.userTeamArr.user.name,phone:c.userTeamArr.user.phone},success:function(b){return void 0!==b.ERR?void alert("server responded with ERROR"):void(2==b?zuck.alert("warning","대관 신청 실패","이미 예약된 시간대 입니다."):4==b?zuck.alert("warning","대관 신청 실패","대관시간 1시간 이전까지만 신청 가능합니다."):1==b?(zuck.alert("success","대관 신청 성공","대관이 성공적으로 신청되었습니다."),$(".note_overlay").css("opacity","0"),RESV.view.overlay.genResvStep3(a)):zuck.alert("danger","대관 신청 불가","서버에서 정보를 받지 못하였습니다. 다시 한번 신청해 주세요."))},error:function(a){zuck.alert("danger","대관 신청 불가","잘못된 접근 입니다.")}})},checkCoupon:function(a){return $.ajax({url:"/api/v1/reservation/checkcoupon",dataType:"json",method:"POST",data:{fNum:SERVER.fNum,totalPrice:a.price,couponCode:a.couponCode}})},requestToAdmCoupon:function(a,b,c){$.ajax({url:"/api/v1/reservation/requestcoupon",dataType:"json",method:"POST",data:{fNum:SERVER.fNum,pay_chk:SERVER.pay,totalPrice:a.price,scheduleList:JSON.stringify(b),sDate:$.datepicker.formatDate("yy-mm-dd",a.sDate),sTime:a.sTime,time_length:a.time_length,couponCode:a.couponCode,tNum:a.tNum,tName:a.tName,userName:c.userTeamArr.user.name,phone:c.userTeamArr.user.phone},success:function(b){"SUCCESS"==b.flag?(zuck.alert("success","대관 신청 성공","대관이 성공적으로 신청되었습니다."),$(".note_overlay").css("opacity","0"),a.flag="COUPON",a.response_coupon=b,RESV.view.overlay.genResvStep3(a)):2==b?zuck.alert("warning","대관 신청 실패","이미 예약된 시간대 입니다."):4==b?zuck.alert("warning","대관 신청 실패","대관시간 1시간 이전까지만 신청 가능합니다."):5==b?(zuck.alert("warning","대관 신청 실패","이미 사용된 쿠폰입니다."),$(".invalid-form-error-message").html("<h6> ※ 이미 사용된 쿠폰입니다.</h6>")):6==b?(zuck.alert("warning","대관 신청 실패","유효하지 않은 쿠폰번호 입니다."),$(".invalid-form-error-message").html("<h6> ※ 유효하지 않은 쿠폰번호 입니다.</h6>")):zuck.alert("danger","대관 신청 불가","서버에서 정보를 받지 못하였습니다. 다시 한번 신청해 주세요.")},error:function(a){zuck.alert("danger","대관 신청 불가","잘못된 접근 입니다.")}})},requestToPayment:function(a,b,c){$("#paymentForm").length>0&&$("#paymentForm").remove();var d=$('<form action="/'+RESV.request.split("/")[1]+'/detail/requestPayment" id="paymentForm" method="post" style="display:none;" target="paymentPopup"></form>'),e=document.createElement("input");$(e).attr("type","hidden"),$(e).attr("name","paramArr");var f={flag:"pc",team_chk:0,fNum:SERVER.fNum,totalPrice:a.price,scheduleList:JSON.stringify(b),pNum:c.userTeamArr.user.num,pay_chk:c.pay,sDate:$.datepicker.formatDate("yy-mm-dd",a.sDate),sTime:a.sTime,time_length:a.time_length,couponCode:a.couponCode,tNum:a.tNum,tName:a.tName,pName:c.userTeamArr.user.name,phone:c.userTeamArr.user.phone,resvInfo:a,resvDate:a.sDate};$(e).attr("value",JSON.stringify(f)),$(d).append(e),$("body").append(d),window.open("","paymentPopup","width=400, height=460,  top="+(window.screen.height/2-300)+", left="+(window.screen.width/2-220)+", toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no"),d.submit()},requestToVbank:function(a,b,c){$.ajax({url:"/payment/vBankResult_utf",dataType:"json",method:"POST",data:{team_chk:0,pay_chk:c.pay,fNum:SERVER.fNum,totalPrice:a.price,scheduleList:JSON.stringify(b),sDate:$.datepicker.formatDate("yy-mm-dd",a.sDate),sTime:a.sTime,time_length:a.time_length,couponCode:a.couponCode,tNum:a.tNum,tName:a.tName,pNum:c.userTeamArr.user.num,pName:c.userTeamArr.user.name,userName:c.userTeamArr.user.name,phone:c.userTeamArr.user.phone,receiptType:$("input[name='ReceiptType']").val(),receiptTypeNo:$("input[name='ReceiptTypeNo']").val()},success:function(b){return"SUCCESS"==b.flag?(zuck.alert("success","대관 신청 성공","대관이 성공적으로 신청되었습니다."),$(".note_overlay").css("opacity","0"),a.flag="VBANK",a.vbankBankCode=b.vbankBankCode,a.vbankBankName=b.vbankBankName,a.vbankExpDate=b.vbankExpDate,a.vbankNum=b.vbankNum,a.response_coupon=b.response_coupon,void RESV.view.overlay.genResvStep3(a)):void(2==b?zuck.alert("warning","대관 신청 실패","이미 예약된 시간대 입니다."):4==b?zuck.alert("warning","대관 신청 실패","대관시간 1시간 이전까지만 신청 가능합니다."):5==b?(zuck.alert("warning","대관 신청 실패","이미 사용된 쿠폰입니다."),$(".invalid-form-error-message").html("<h6> ※ 이미 사용된 쿠폰입니다.</h6>")):6==b?(zuck.alert("warning","대관 신청 실패","유효하지 않은 쿠폰번호 입니다."),$(".invalid-form-error-message").html("<h6> ※ 유효하지 않은 쿠폰번호 입니다.</h6>")):zuck.alert("danger","대관 신청 불가","서버에서 정보를 받지 못하였습니다. 다시 한번 신청해 주세요."))},error:function(a){zuck.alert("danger","대관 신청 불가","잘못된 접근 입니다.")}})}},RESV.action.priceComma=function(a){var b,c,d;for(a+="",c=a.length%3,b=a.length,d=a.substring(0,c);c<b;)""!==d&&(d+=","),d+=a.substring(c,c+3),c+=3;return d},RESV.action.timeToSeconds=function(a){return a=a.split(/:/),3600*parseInt(a[0])+60*parseInt(a[1])+parseInt(a[2])},RESV.action.timeToHMS=function(a){var b,c="",d="",e="00";return c=a<100?"0"+parseInt(a/10):""+parseInt(a/10),d=6*(a%10)<10?"0"+6*(a%10):""+6*(a%10),b=c+":"+d+":"+e,"24:00:00"==b&&(b="23:59:59"),b},RESV.action.leftFold=function(){$("#calendarTitle").click(function(){"open"===RESV.toggler.calendar?(RESV.toggler.calendar="close",$("#calendarHolder").css({height:"1px",width:"1px",overflow:"hidden"}),$("#calendarTitle>.glyphicon").removeClass("glyphicon-minus").addClass("glyphicon-plus")):(RESV.toggler.calendar="open",$("#calendarHolder").css({height:"",width:"",overflow:""}),$("#calendarTitle>.glyphicon").removeClass("glyphicon-plus").addClass("glyphicon-minus"))})},RESV.action.listener=function(a){setTimeout(function(){$("#detail-get-direction").on("click",function(){var b="http://map.naver.com/index.nhn?menu=route&mapMode=0&eText="+SERVER.fName+"&elng="+SERVER.longitude+"&elat="+SERVER.latitude+"&pathType=0";ga("send","event","detail","click","getDirection_"+SERVER.fNum,a.loginChk),window.open(b)})},300),$("#tableDate").change(function(){RESV.view.table.fetchTable($("#tableDate").val()),RESV.view.calendar.setCalendarDate($("#tableDate").val())}),$("#resvSubmit").click(function(b){1===a.loginChk?($("body").append("<div id='dim'></div>"),RESV.view.overlay.genResvStep1(a)):1!==a.loginChk&&($(window).scrollTop(50),CORE.enter(0,"&nextOffset="+RESV.view.calendar.getOffset()),zuck.alert("primary","대관 신청 불가","로그인 후 예약 / 대관이 가능합니다."))}),$("#teamResist").click(function(b){1===a.loginChk?t_mask_step1():($(window).scrollTop(50),zuck.alert("primary","관내 팀 신청 불가","로그인 후에 관내 팀 등록이 가능합니다."))}),$("#resvDown").click(function(){window.location=RESV.download+"?path=reserv&file_name="+SERVER.resvFile}),$("#teamresistDown").click(function(){window.location=RESV.download+"?path=teamresist&file_name="+SERVER.teamresistFile})},RESV.view.table={fetchTable:function(a,b){var c,d,e=0,f="",g="",h=SERVER.resvArr[a],i=new Date(SERVER.time);i.setDate(i.getDate()+parseInt(a));var j=i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear();for($("#tableContentsPanel").html("");e<h.scheduleCount;)f=RESV.action.timeToSeconds(h[e].sTime+":00")>=RESV.action.timeToSeconds(SERVER.nightTime)?"야 간":RESV.action.timeToSeconds(h[e].sTime+":00")<RESV.action.timeToSeconds(SERVER.dayTime)?"새 벽":"주 간",c=new Date(j+" "+h[e].sTime+":00"),c=c.getTime(),d="",null===h[e].rNum?(d="<td><h5>-</h5></td>",g=parseInt(SERVER.timestamp)+36e5>c?'<button class="btn btn-grey resv disabled">예약 불가</button>':'<button class="btn btn-red resv" name='+e+" value="+e+">예약 가능</button>"):2===h[e].state?(d='<td style="color:#9e021a"><h5><strong>'+h[e].tName+"</strong></h5></td>",g='<button class="btn btn-grey resv disabled">예약 마감</button>'):(d='<td style="color:#9e021a"><h5><strong>-</strong></h5></td>',g='<button class="btn btn-grey resv disabled">예약 중</button>'),$("#tableContentsPanel").append("<tr><td><h5>"+h[e].sTime+" ~ "+h[e].eTime+"</h5></td><td><h5>"+RESV.action.priceComma(h[e].price)+"</h5></td>"+d+"<td><h5>"+f+"</h5></td><td><h5>"+g+"</h5></td></tr>"),RESV.view.table.addResvBtnListener(h,e,b),e++},addResvBtnListener:function(a,b,c){$(".resv[name="+b+"]").click(function(){var c=a[b];1===RESV.server.loginChk?RESV.view.overlay.genResvStep2(c,RESV.server):1!==RESV.server.loginChk&&($(window).scrollTop(50),CORE.enter(0,"&nextOffset="+RESV.view.calendar.getOffset()),zuck.alert("primary","대관 신청 불가","로그인 후 예약 / 대관이 가능합니다."))})},setTableDate:function(){var a=new Date(SERVER.time);$("#txtDate").val($.datepicker.formatDate("dd M yy",new Date(SERVER.time))),$("#tableDate").datepicker();for(var b=0;b<30;b++)$("#tableDate").append("<option value="+b+">"+$.datepicker.formatDate("yy/mm/dd (D)",a,{dayNamesShort:["일","월","화","수","목","금","토"]})+"</option>"),a.setDate(a.getDate()+1);$(".tableDate").val(RESV.view.calendar.getOffset())}},RESV.view.setupDatepicker=function(){RESV.view.calendar.drawDatePicker(),RESV.view.calendar.genBadge(SERVER.resvArr),RESV.view.calendar.redefineUpdate();var a=new Date(SERVER.time);a.getHours()<6&&(SERVER.dayOffset=-1)},RESV.view.calendar={drawDatePicker:function(){var a=new Date(SERVER.time),b=a.getDate(),c=a.getMonth()%12,d=a.getFullYear();$("#calendar").datepicker({minDate:new Date(d,c,b-1),maxDate:new Date(d,c,b+29),dayNames:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],dayNamesMin:["일","월","화","수","목","금","토"],dayNamesShort:["일","월","화","수","목","금","토"],monthNames:["1","2","3","4","5","6","7","8","9","10","11","12"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],altFormat:"yy-mm-dd",inline:!1,onSelect:function(a,b){$(".timeselect-layer-container .resv-info select").val(RESV.view.calendar.getOffset()).change()},beforeShowDay:function(a){return[!0,"datepicker-color-handle"]}})},genBadge:function(a){$("a.ui-state-default span.badge").remove(),$("a.ui-state-default").append('<span class="badge" style="position:absolute; margin-left:-4px;margin-top:-2px;font-size:10px;"></span>');for(var b,c=0,d=$("#calendar tr td a span").length;void 0!==$("#calendar td a span")[c];)b="Prev"==$("#calendar div div a.ui-state-disabled span").text()?jQuery.grep(a,function(a,b){return parseInt(a.date_offset)==parseInt(c)}):jQuery.grep(a,function(a,b){return parseInt(a.date_offset)==parseInt(c+(30-d))}),0!==b.length?$($("#calendar td a span")[c]).html("예약가능"):$($("#calendar td a span")[c]).html(""),c++},redefineUpdate:function(){var a=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(b){a.apply(this,[b]),RESV.view.calendar.genBadge(SERVER.resvArr)}},getOffset:function(){var a=new RegExp("^([0-9]{2})/([0-9]{2})/"),b=parseInt(a.exec($("#calendar").val())[1]),c=parseInt(a.exec($("#calendar").val())[2]),d=new Date(SERVER.time),e=d.getMonth()+1,f=d.getDate();return e==b?c-f:new Date(d.getFullYear(),e,0).getDate()-f+c},setCalendarDate:function(a){var b=new Date(SERVER.time);b.setDate(b.getDate()+parseFloat(a)),$("#calendar").datepicker("setDate",b)}},RESV.view.overlay={drawSkeleton:function(){$("body").append("<div id='dim'></div>");var a=$(document).height();$("#dim").height(a),$("#overlay").html(""),$("#overlay").append(SERVER.skel.overlay)},genResvStep1:function(a){RESV.view.overlay.drawSkeleton(),$("#stepHolder").addClass("step1"),$(".rightSpaceStep").addClass("r1").html("<h6><strong>대관하실 시간을 선택하세요</strong></h6>"),$("#overlayContainer").append(SERVER.skel.resvTable),RESV.view.table.setTableDate(),RESV.view.table.fetchTable($("#tableDate").val(),a),$("#tableDate").change(function(){$(".tableDate").val($("#tableDate").val()),RESV.view.table.fetchTable($("#tableDate").val()),RESV.view.calendar.setCalendarDate($("#tableDate").val())}),$("#dim").each(function(){this.scrollIntoView(!0)}),$("#exitHolder>.exit").click(function(){$("#dim").remove(),$("#overlayContainer").remove()})},genResvStep2:function(a,b,c,d,e){RESV.view.overlay.drawSkeleton(),$("#stepHolder").addClass("step2"),$(".rightSpaceStep").addClass("r2"),$("#overlayContainer").append(SERVER.skel.resvChk),RESV.AJAX.get_agreement(),$("#userTeam").html("신청팀&nbsp&nbsp : "),0!==e.userTeamArr.resvTeam.info.length&&$("#teamName").html(SERVER.userTeamArr.resvTeam.list),$("#userName").html("신청자&nbsp&nbsp :&nbsp&nbsp&nbsp&nbsp&nbsp"+SERVER.userTeamArr.user.name),$("#userPhone").html("연락처&nbsp&nbsp :&nbsp&nbsp&nbsp&nbsp&nbsp"+add_hyphen_phone(SERVER.userTeamArr.user.phone));var f=new Date(SERVER.time);f.setDate(f.getDate()+parseInt(b));var g=0,h=0,j=[],k={};for(i=c;i<=d;i++)g+=a[i].time_length,h+=a[i].unit_price,j.push(a[i]);var l=new Date(a[c].start_date);k.sDate=l,k.sTime=a[c].start_time,k.eTime=a[d].end_time,k.time_length=g,k.price=h,k.couponCode="noCoupon";var m=a[d].end_time;"00:00"==m&&(m="24:00"),$("#resvDate").html(a[c].start_date),$("#resvTime").html(a[c].start_time+" ~ "+m),$("#resvPrice").html(RESV.action.priceComma(h)),$("#totalCount").html("총 금액 : "+RESV.action.priceComma(h)+" 원"),$("#resvDoc").on("change",function(){$("#resvFileName").text($("#resvDoc")[0].files[0].name)}),$("#innerResvDown").click(function(a){window.location=RESV.download+"?path=reserv&file_name="+SERVER.resvFile}),$(".agree-resv .text-holder").click(function(a){$("#agreeResv").click()}),$(".agree-fac .text-holder").click(function(a){$("#agreeFac").click()}),$(".agree-fac2 .text-holder").click(function(a){$("#agreeFac2").click()}),$("#useCoupon").change(function(){$(this).is(":checked")?$("#couponCode").removeAttr("disabled"):$("#couponCode").attr("disabled",!0)}),$("#submit").click(function(){$("#useCoupon").is(":checked")?""!=$("#couponCode").val()?k.couponCode=$("#couponCode").val():($("#useCoupon").prop("checked",!1),$("#couponCode").attr("disabled",!0),k.couponCode="noCoupon"):k.couponCode="noCoupon",1===e.loginChk?RESV.view.overlay.submitResv(k,j,e):1!==e.loginChk&&($(window).scrollTop(50),CORE.enter(0,"&nextOffset="+RESV.view.calendar.getOffset()),zuck.alert("primary","대관 신청 불가","로그인 후 예약 / 대관이 가능합니다."))}),$("#dim").each(function(){this.scrollIntoView(!0)}),$("#exitHolder>.exit").click(function(){$("#dim").remove(),$("#overlayContainer").remove()}),"VBANK"==$(':radio[name="paymentGubun"]:checked').val(),$('input[name="paymentGubun"]').change(function(){"VBANK"==$(this).val()?$("#couponView").hide():"SOCAR"==$(this).val()?$("#couponView").show():($("#couponView").hide(),$("#receiptTypeView").hide(),$("#receiptTypeNoView").hide())}),$(".numbersOnly").keyup(function(){this.value=this.value.replace(/[^0-9]/g,"")}),ga("ec:addProduct",{id:"P"+SERVER.service+SERVER.fNum,name:SERVER.service+"_"+SERVER.fNum+"_resv",category:"reservation",brand:"iamground",variant:"pc",price:a.price,quantity:1}),ga("ec:setAction","checkout",{step:1}),ga("send","pageview")},genResvStep3:function(a,b,c){var d=$("#teamName option:selected").text();0==RESV.server.userTeamArr.resvTeam.info.length&&(d=$("#teamName").val());var e=$("#totalCount").html();RESV.view.overlay.drawSkeleton(),$("#stepHolder").addClass("step3"),$(".rightSpaceStep").addClass("r3"),$("#overlayContainer").append(SERVER.skel.resvFin),RESV.AJAX.get_agreement(),$("#userTeam").html("신청팀&nbsp&nbsp :&nbsp&nbsp&nbsp&nbsp&nbsp"+d),$("#userName").html("신청자&nbsp&nbsp :&nbsp&nbsp&nbsp&nbsp&nbsp"+SERVER.userTeamArr.user.name),$("#userPhone").html("연락처&nbsp&nbsp :&nbsp&nbsp&nbsp&nbsp&nbsp"+add_hyphen_phone(SERVER.userTeamArr.user.phone)),$("#totalCount").html(e),"VBANK"==a.flag?($("#vbankBankName").parent().show(),$("#vbankBankName").html("가상계좌 은행명&nbsp&nbsp :&nbsp&nbsp&nbsp&nbsp&nbsp"+a.vbankBankName),$("#vbankNum").parent().show(),$("#vbankNum").html("가상계좌 계좌번호&nbsp&nbsp :&nbsp&nbsp&nbsp&nbsp&nbsp"+a.vbankNum),$("#totalCount").html(e),a.response_coupon.discountPrice!=a.price&&$("#totalCount").html("결제가 : "+RESV.action.priceComma(a.response_coupon.discountPrice)+" 원 (원가 : "+RESV.action.priceComma(a.price)+" 원)")):"COUPON"==a.flag&&void 0!=a.response_coupon.discountPrice?a.response_coupon.discountPrice!=a.price&&$("#totalCount").html("결제가 : "+RESV.action.priceComma(a.response_coupon.discountPrice)+" 원 (원가 : "+RESV.action.priceComma(a.price)+" 원)"):void 0!=c&&c!=a.price&&$("#totalCount").html("결제가 : "+RESV.action.priceComma(c)+" 원 (원가 : "+RESV.action.priceComma(a.price)+" 원)");var f=new Date(SERVER.time);f.setDate(f.getDate()+parseInt($("#tableDate").val()));var g=new Date(a.sDate),h=a.eTime;"00:00"==h&&(h="24:00"),$("#resvDate").html($.datepicker.formatDate("yy.mm.dd",g)),$("#resvTime").html(a.sTime+" ~ "+h),$("#resvPrice").html(RESV.action.priceComma(a.price)),$("#closeBtn").click(function(){$("#dim").remove(),$("#overlayContainer").remove(),location.reload()}),$("#exitHolder>.exit").click(function(){$("#dim").remove(),$("#overlayContainer").remove(),location.reload()}),"undefined"==typeof b&&(ga("ec:addProduct",{id:"P"+SERVER.service+SERVER.fNum,name:SERVER.service+"_"+SERVER.fNum+"_resv",category:"reservation",brand:"iamground",variant:"pc",price:a.price,coupon:"",quantity:1}),ga("ec:setAction","purchase",{id:"T"+SERVER.service+SERVER.fNum+"_"+$.datepicker.formatDate("yy-mm-dd",f)+"_"+a.sTime,affiliation:"iamground",revenue:a.price,tax:"",shipping:"",coupon:""}),ga("send","pageview"))},submitResv:function(a,b,c){if(RESV.view.overlay._validate(c)){var d="max",e=$("#teamName").val();0!==c.userTeamArr.resvTeam.info.length&&(d=c.userTeamArr.resvTeam.info[$("#teamName option:selected").val()].tNum,e=c.userTeamArr.resvTeam.info[$("#teamName option:selected").val()].tName);var f="[예약 정보 최종 확인]\n\n"+SERVER.fName+"\n"+$.datepicker.formatDate("yy-mm-dd",a.sDate)+" "+a.sTime+"-"+a.eTime+"\n\n** 대관 장소, 날짜/시간을 한번 더 확인해주세요.\n(대관 시간은 '24시간제'로 표시됩니다.\n오전/오후 시간 유의바랍니다.)\n\n** 아이엠그라운드 가입시 인증된 연락처로 결제 정보, 대관 현황이 발송됩니다.\n- 계정 연락처 : "+add_hyphen_phone(SERVER.userTeamArr.user.phone);a.tNum=d,a.tName=e,confirm(f)&&("CARD"==$(':radio[name="paymentGubun"]:checked').val()?$.when(RESV.AJAX.checkCoupon(a)).done(function(d){1==d.response?0==d.discountPrice?RESV.AJAX.requestToAdmCoupon(a,b,c):RESV.AJAX.requestToPayment(a,b,c):5==d.response?(zuck.alert("warning","대관 신청 실패","이미 사용된 쿠폰입니다."),$(".invalid-form-error-message").html("<h6> ※ 이미 사용된 쿠폰입니다.</h6>")):6==d.response?(zuck.alert("warning","대관 신청 실패","유효하지 않은 쿠폰번호 입니다."),$(".invalid-form-error-message").html("<h6> ※ 유효하지 않은 쿠폰번호 입니다.</h6>")):zuck.alert("danger","대관 신청 불가","서버에서 정보를 받지 못하였습니다. 다시 한번 신청해 주세요.")}).fail(function(){zuck.alert("danger","대관 신청 불가","잘못된 접근 입니다.")}):"VBANK"==$(':radio[name="paymentGubun"]:checked').val()?$.when(RESV.AJAX.checkCoupon(a)).done(function(d){1==d.response?0==d.discountPrice?RESV.AJAX.requestToAdmCoupon(a,b,c):RESV.AJAX.requestToVbank(a,b,c):5==d.response?(zuck.alert("warning","대관 신청 실패","이미 사용된 쿠폰입니다."),$(".invalid-form-error-message").html("<h6> ※ 이미 사용된 쿠폰입니다.</h6>")):6==d.response?(zuck.alert("warning","대관 신청 실패","유효하지 않은 쿠폰번호 입니다."),$(".invalid-form-error-message").html("<h6> ※ 유효하지 않은 쿠폰번호 입니다.</h6>")):zuck.alert("danger","대관 신청 불가","서버에서 정보를 받지 못하였습니다. 다시 한번 신청해 주세요.")}).fail(function(){zuck.alert("danger","대관 신청 불가","잘못된 접근 입니다.")}):"BANK"==$(':radio[name="paymentGubun"]:checked').val()&&1==c.pay?$.when(RESV.AJAX.fileUpload()).done(function(d){if(1==d)RESV.AJAX.requestToAdm(a,b,c);else{zuck.alert("danger","업로드 실패","파일 업로드를 실패하였습니다. 다시 시도해 주세요.");var e=document.getElementByName("resvDoc");e[0].select(),document.selection.clear}}).fail(function(){zuck.alert("danger","대관 신청 불가","잘못된 접근 입니다.")}):"SOCAR"==$(':radio[name="paymentGubun"]:checked').val()?RESV.AJAX.requestToAdmCoupon(a,b,c):RESV.AJAX.requestToAdm(a,b,c))}},__fileChk:function(){var a=$("#resvDoc"),b=a[0].files;return file_var=b,0===file_var.length?($(".invalid-form-error-message").html("<h6> ※ 신청서를 등록하여 주세요.</h6>"),file_val=!1):0!==file_var&&file_var[0].size>1024e5?($(".invalid-form-error-message").html("<h6> ※ 파일 용량은 100MB 이하로 첨부하여 주세요.</h6>"),file_val=!1):2!=file_var[0].name.split(".").length?($(".invalid-form-error-message").html("<h6> ※ 정확한 파일을 첨부하여 주세요.</h6>"),file_val=!1):"hwp"!=file_var[0].name.split(".")[file_var[0].name.split(".").length-1]&&"doc"!=file_var[0].name.split(".")[file_var[0].name.split(".").length-1]&&"docx"!=file_var[0].name.split(".")[file_var[0].name.split(".").length-1]?($(".invalid-form-error-message").html("<h6> ※ 파일의 확장자가 'hwp', 'doc', 'docx'인 파일만 첨부 할 수 있습니다.</h6>"),file_val=!1):(RESV.fileData.append("reserv_doc",b[0]),file_val=!0),file_val},_validate:function(a){var b=!0;return 1==a.pay&&(b=RESV.view.overlay.__fileChk()),$("input:checkbox[name='agreeResv']").is(":checked")!==!0?($(".invalid-form-error-message").html("<h6> ※ 개인정보 취급방침에 동의하지 않았습니다.</h6>"),b=!1):$("input:checkbox[name='agreeFac']").is(":checked")!==!0?($(".invalid-form-error-message").html("<h6> ※ 시설 약관에 동의하지 않았습니다.</h6>"),b=!1):$("input:checkbox[name='agreeFac2']").is(":checked")!==!0?($(".invalid-form-error-message").html("<h6> ※ 서명 대체란에 체크하지 않았습니다.</h6>"),b=!1):""===$("#teamName").val()?(0!==a.userTeamArr.resvTeam.info.length?$(".invalid-form-error-message").html("<h6> ※ 팀을 선택 하여 주세요.</h6>"):$(".invalid-form-error-message").html("<h6> ※ 팀명을 입력 하여 주세요.</h6>"),b=!1):0==a.userTeamArr.resvTeam.info.length&&($("#teamName").val().length<=2||$("#teamName").val().length>=15)?($(".invalid-form-error-message").html("<h6> ※ 팀명은 3글자 이상, 14글자 이하의 한글, 영어, 숫자, 띄어쓰기, _만 가능합니다. </h6>"),b=!1):0==a.userTeamArr.resvTeam.info.length&&/[^가-힣\w\s]/.test($("#teamName").val())&&($(".invalid-form-error-message").html("<h6> ※ 팀명은 3글자 이상, 14글자 이하의 한글, 영어, 숫자, 띄어쓰기, _만 가능합니다. </h6>"),b=!1),b}},RESV.agreeUrl="/futsal/detail/agreement.php",RESV.upload="/futsal/detail/upload.php",RESV.request="/futsal/detail/request.php",RESV.download="/futsal/detail/download.php",CORE.toggleScroll(),$(window).ready(function(){__init_detail(),__init_resv(),__init_resvFut()}).resize(function(){CORE.view.setLeftHeight(),$(window).scroll()});